# WARNING: This file was generated by chef, any edits you make here will be nuked!
# Instead consider amending the chef recipe and re-deploying with Knife Solo

check process <%= @app_name %>_<%= @environment %>_unicorn_master with pidfile <%= @environment_root %>/shared/pids/unicorn.pid
  start program "/etc/init.d/<%= @app_name %>_<%= @environment %>_unicorn start"
  stop program "/etc/init.d/<%= @app_name %>_<%= @environment %>_unicorn stop"
  if 5 restarts within 5 cycles then timeout

<% @unicorn_workers.times do |i| %>
check process <%= @app_name %>_<%= @environment %>_unicorn_worker_<%= i %> with pidfile <%= @environment_root %>/shared/pids/unicorn.<%= i %>.pid
  start program = "/bin/true"
  stop program = "/etc/init.d/<%= @app_name %>_<%= @environment %>_unicorn kill_worker <%= i %>"
  if mem is greater than 175.0 MB for 1 cycles then restart
  if cpu is greater than 25% for 1 cycles then restart

<% end %>
